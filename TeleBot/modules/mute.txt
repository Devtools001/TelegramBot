from TeleBot import pgram
from pyrogram import filters
from functools import wraps
from TeleBot import BOT_ID
from pyrogram.enums import ChatType
from pyrogram import Client
from pyrogram.types import Message 

async def is_bot_admin(app : Client, message: Message) -> bool:
    administrators = []
    async for m in app.get_chat_members(chat_id, filter=enums.ChatMembersFilter.ADMINISTRATORS):
        administrators.append(m.user.id)

    if message.chat.id == ChatType.PRIVATE or message.from_user.id in administrators:
        return True

    
def bot_admins(func):
    @wraps(func)
    async def is_admin(_, message,*args,**kwargs):
        administrators = []
        async for m in app.get_chat_members(chat_id, filter=enums.ChatMembersFilter.ADMINISTRATORS):
            administrators.append(m.user.id)

        if BOT_ID not in administrators:
            await message.reply_text("i am not admin")    
    

@pgram.on_message(filters.command("muteall"))
@bot_admin
@user_admin
async def mute_all(_,msg):
    chat_id=msg.chat.id            
    if msg.reply_to_message:
        await app.restrict_chat_member(chat_id, msg.reply_to_message.from_user.id,ChatPermissions(can_send_messages=False))       
    else:
        await msg.reply_text("ᴇɪᴛʜᴇʀ ɪ ᴅᴏɴ'ᴛ ʜᴀᴠᴇ ᴛʜᴇ ʀɪɢʜᴛ ᴛᴏ ʀᴇsᴛʀɪᴄᴛ ᴜsᴇʀs ᴏʀ ʏᴏᴜ ᴀʀᴇ ɴᴏᴛ ɪɴ sᴜᴅᴏ ᴜsᴇʀs")  
                                         
    
